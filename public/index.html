<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Causa Digital - Plataforma de doaÃ§Ãµes gamificada com transparÃªncia total. Doe, acumule pontos, desbloqueie conquistas e veja o impacto real da sua generosidade.">
  <meta name="keywords" content="doaÃ§Ã£o, caridade, ONG, transparÃªncia, gamificaÃ§Ã£o, causas sociais, voluntariado">
  <meta name="author" content="Causa Digital">
  <meta name="robots" content="index, follow">
  
  <!-- Open Graph / Social Media -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Causa Digital - Transforme Vidas com TransparÃªncia">
  <meta property="og:description" content="Plataforma de doaÃ§Ãµes gamificada onde vocÃª acompanha cada centavo do seu apoio.">
  <meta property="og:image" content="/og-image.png">
  <meta property="og:url" content="https://causadigital.org">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Causa Digital - Transforme Vidas com TransparÃªncia">
  <meta name="twitter:description" content="Plataforma de doaÃ§Ãµes gamificada com transparÃªncia total.">
  
  <!-- Theme Color -->
  <meta name="theme-color" content="#059669">
  
  <title>Causa Digital - Transforme Vidas com TransparÃªncia</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’š</text></svg>">
  <link rel="canonical" href="https://causadigital.org">
  <script src="auth-helper.js" defer></script>
</head>
<body>
  <nav>
    <div class="container nav-container">
      <a href="index.html" class="logo">Causa Digital</a>
      <div class="nav-links">
        <a href="campanhas.html">Campanhas</a>
        <a href="ongs.html">ONGs</a>
        <button id="modoBtn" class="btn-toggle">ğŸŒ™</button>
      </div>
    </div>
  </nav>
  <header class="hero">
    <div class="container">
      <span class="badge badge-success animate-fade-in" style="margin-bottom: 1rem;">ğŸŒ± Plataforma 100% Transparente & Gamificada</span>
      <h1 class="animate-fade-in-up">Transforme vidas com<br>transparÃªncia total</h1>
      <p class="animate-fade-in-up delay-100">A plataforma de doaÃ§Ãµes gamificada onde vocÃª acompanha cada centavo do seu apoio. Doe, acumule pontos, desbloqueie conquistas e veja o impacto real da sua generosidade.</p>
      <div class="hero-buttons animate-fade-in-up delay-200">
        <a href="campanhas.html" class="btn-primary">ğŸ¯ Ver Campanhas Ativas</a>
        <a href="cadastro.html" class="btn-secondary">ğŸ¢ Cadastrar ONG</a>
      </div>
    </div>
  </header>

  <!-- SeÃ§Ã£o de EstatÃ­sticas da Plataforma -->
  <section class="section" style="background: var(--bg-secondary); padding: 3rem 0;">
    <div class="container">
      <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));">
        <div class="stat-card animate-fade-in-up">
          <span class="stat-value" id="statArrecadado">R$ 0</span>
          <span class="stat-label">Total Arrecadado</span>
        </div>
        <div class="stat-card animate-fade-in-up delay-100">
          <span class="stat-value" id="statDoacoes">0</span>
          <span class="stat-label">DoaÃ§Ãµes Realizadas</span>
        </div>
        <div class="stat-card animate-fade-in-up delay-200">
          <span class="stat-value" id="statOngs">0</span>
          <span class="stat-label">ONGs Cadastradas</span>
        </div>
        <div class="stat-card animate-fade-in-up delay-300">
          <span class="stat-value" id="statCampanhas">0</span>
          <span class="stat-label">Campanhas Ativas</span>
        </div>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="container">
      <div style="display: flex; justify-content: space-between; align-items: end; margin-bottom: 2rem;">
        <div>
          <h2>ğŸ”¥ Campanhas em Destaque</h2>
          <p class="subtitle">Causas urgentes que precisam do seu apoio agora</p>
        </div>
        <a href="campanhas.html" style="color: var(--primary); font-weight: 600; text-decoration: none;">Ver todas &rarr;</a>
      </div>
      <div id="destaques" class="grid">
        <div class="card skeleton">
          <div style="height: 200px; background: var(--bg-secondary); border-radius: var(--radius); margin-bottom: 1rem;"></div>
          <div style="height: 20px; width: 70%; background: var(--bg-secondary); margin-bottom: 0.5rem;"></div>
          <div style="height: 16px; width: 40%; background: var(--bg-secondary);"></div>
        </div>
        <div class="card skeleton">
          <div style="height: 200px; background: var(--bg-secondary); border-radius: var(--radius); margin-bottom: 1rem;"></div>
          <div style="height: 20px; width: 70%; background: var(--bg-secondary); margin-bottom: 0.5rem;"></div>
          <div style="height: 16px; width: 40%; background: var(--bg-secondary);"></div>
        </div>
        <div class="card skeleton">
          <div style="height: 200px; background: var(--bg-secondary); border-radius: var(--radius); margin-bottom: 1rem;"></div>
          <div style="height: 20px; width: 70%; background: var(--bg-secondary); margin-bottom: 0.5rem;"></div>
          <div style="height: 16px; width: 40%; background: var(--bg-secondary);"></div>
        </div>
      </div>
    </div>
  </section>
  <section class="section" style="background: var(--bg-secondary);">
    <div class="container">
      <div style="text-align: center; margin-bottom: 3rem;">
        <h2>ğŸ† Top Doadores da Semana</h2>
        <p class="subtitle" style="margin: 0 auto;">Reconhecimento para quem faz a diferenca</p>
      </div>
      <div id="ranking" class="grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
      </div>
    </div>
  </section>
  <section class="section">
    <div class="container">
      <div style="text-align: center; margin-bottom: 3rem;">
        <h2>âš¡ Como Funciona</h2>
        <p class="subtitle" style="margin: 0 auto;">Transparencia total, do primeiro clique ao impacto final</p>
      </div>
      <div class="grid">
        <div class="card">
          <span class="badge badge-primary">Passo 1</span>
          <h3>Cadastre sua ONG</h3>
          <p>Crie campanhas com metas claras, imagens e metricas de impacto para inspirar confianca.</p>
        </div>
        <div class="card">
          <span class="badge badge-primary">Passo 2</span>
          <h3>Engaje doadores</h3>
          <p>Doadores ganham pontos, sobem de nivel e desbloqueiam badges conforme contribuem.</p>
        </div>
        <div class="card">
          <span class="badge badge-primary">Passo 3</span>
          <h3>Acompanhe o impacto</h3>
          <p>Veja em tempo real como sua doacao esta transformando vidas com total transparencia.</p>
        </div>
      </div>
    </div>
  </section>
  <footer style="padding: 3rem 0; border-top: 1px solid var(--border-color);">
    <div class="container" style="text-align: center;">
      <p style="color: var(--text-secondary);">ğŸ’š 2025 Causa Digital - Transformando vidas com transparÃªncia</p>
    </div>
  </footer>

  <!-- Toast Container para notificaÃ§Ãµes -->
  <div class="toast-container" id="toastContainer"></div>
  <script>
    // Sistema de tema claro/escuro
    const body = document.body;
    const btn = document.getElementById("modoBtn");
    if (localStorage.getItem("theme") === "dark") {
      body.classList.add("dark");
      btn.textContent = "â˜€ï¸";
    }
    btn.addEventListener("click", () => {
      body.classList.toggle("dark");
      const dark = body.classList.contains("dark");
      localStorage.setItem("theme", dark ? "dark" : "light");
      btn.textContent = dark ? "â˜€ï¸" : "ğŸŒ™";
    });

    // Dados de exemplo para fallback
    const mockDestaques = [
      { _id: "1", titulo: "Cesta BÃ¡sica para 100 FamÃ­lias", descricao: "Ajude famÃ­lias em vulnerabilidade alimentar a terem refeiÃ§Ãµes dignas.", meta: 5000, arrecadado: 4500, percentualConcluido: 90, categoria: "alimentacao" },
      { _id: "2", titulo: "Material Escolar Completo", descricao: "Kits escolares para crianÃ§as iniciarem o ano letivo com dignidade.", meta: 10000, arrecadado: 8200, percentualConcluido: 82, categoria: "educacao" },
      { _id: "3", titulo: "Medicamentos Essenciais", descricao: "Compra de medicamentos para famÃ­lias em situaÃ§Ã£o de vulnerabilidade.", meta: 8000, arrecadado: 6100, percentualConcluido: 76, categoria: "saude" }
    ];

    const mockRanking = [
      { nome: "JoÃ£o Santos", pontos: 1200, nivel: 3 },
      { nome: "Maria Silva", pontos: 850, nivel: 2 },
      { nome: "Ana Costa", pontos: 300, nivel: 1 }
    ];

    const mockStats = {
      totalArrecadado: 18800,
      totalDoacoes: 156,
      totalOngs: 12,
      totalCampanhas: 8
    };

    // FunÃ§Ã£o para animar contadores
    function animateCounter(element, target, prefix = '', suffix = '') {
      const duration = 1500;
      const start = 0;
      const startTime = performance.now();
      
      function update(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const easeOut = 1 - Math.pow(1 - progress, 3);
        const current = Math.floor(start + (target - start) * easeOut);
        element.textContent = prefix + current.toLocaleString('pt-BR') + suffix;
        
        if (progress < 1) {
          requestAnimationFrame(update);
        }
      }
      requestAnimationFrame(update);
    }

    // Carregar estatÃ­sticas da plataforma
    async function carregarEstatisticas() {
      try {
        const res = await fetch("/api/stats");
        let stats = mockStats;
        if (res.ok) {
          const data = await res.json();
          if (data.totalArrecadado) stats = data;
        }
        
        // Animar os contadores
        animateCounter(document.getElementById("statArrecadado"), stats.totalArrecadado, 'R$ ');
        animateCounter(document.getElementById("statDoacoes"), stats.totalDoacoes);
        animateCounter(document.getElementById("statOngs"), stats.totalOngs);
        animateCounter(document.getElementById("statCampanhas"), stats.totalCampanhas);
      } catch (error) {
        // Usar dados mock com animaÃ§Ã£o
        animateCounter(document.getElementById("statArrecadado"), mockStats.totalArrecadado, 'R$ ');
        animateCounter(document.getElementById("statDoacoes"), mockStats.totalDoacoes);
        animateCounter(document.getElementById("statOngs"), mockStats.totalOngs);
        animateCounter(document.getElementById("statCampanhas"), mockStats.totalCampanhas);
      }
    }

    // Carregar campanhas em destaque
    async function carregarDestaques() {
      const container = document.getElementById("destaques");
      try {
        const res = await fetch("/api/campanhas/destaques?limit=3");
        let dados = [];
        if (res.ok) {
          dados = await res.json();
        }
        if (!dados.length) dados = mockDestaques;
        renderizarDestaques(dados, container);
      } catch (error) {
        renderizarDestaques(mockDestaques, container);
      }
    }

    function getCategoriaEmoji(cat) {
      const emojis = { alimentacao: "ğŸ²", educacao: "ğŸ“š", saude: "ğŸ¥", outros: "ğŸ®" };
      return emojis[cat] || "ğŸ’š";
    }

    function renderizarDestaques(lista, container) {
      container.innerHTML = lista.map((c, index) => {
        const percentual = c.percentualConcluido || Math.round((c.arrecadado / c.meta) * 100);
        return `
          <div class="card animate-fade-in-up delay-${index}00">
            <div style="font-size: 3rem; margin-bottom: 1rem;">${getCategoriaEmoji(c.categoria)}</div>
            <span class="badge badge-primary">${c.categoria || 'causa'}</span>
            <h3 style="margin: 0.75rem 0 0.5rem;">${c.titulo}</h3>
            <p style="font-size: 0.9rem; margin-bottom: 1rem; flex-grow: 1; color: var(--text-secondary);">${c.descricao}</p>
            <div class="progress"><div style="width: ${percentual}%;"></div></div>
            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; margin-top: 0.5rem;">
              <strong style="color: var(--success);">R$ ${c.arrecadado.toLocaleString('pt-BR')}</strong>
              <span style="color: var(--text-secondary);">de R$ ${c.meta.toLocaleString('pt-BR')}</span>
            </div>
            <a href="doacao.html?id=${c._id}" class="btn-primary" style="width: 100%; margin-top: 1.5rem; text-align: center; text-decoration: none; display: block;">ğŸ’š Doar Agora</a>
          </div>
        `;
      }).join("");
    }

    // Carregar ranking de doadores
    async function carregarRanking() {
      const container = document.getElementById("ranking");
      try {
        const res = await fetch("/api/ranking");
        let dados = [];
        if (res.ok) {
          dados = await res.json();
        }
        if (!dados.length) dados = mockRanking;
        renderizarRanking(dados, container);
      } catch (error) {
        renderizarRanking(mockRanking, container);
      }
    }

    function rankingMedal(index) {
      const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
      return medals[index] || `#${index + 1}`;
    }

    function renderizarRanking(lista, container) {
      container.innerHTML = lista.map((u, index) => `
        <div class="card animate-fade-in-up delay-${index}00" style="text-align: center; padding: 1.5rem;">
          <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">${rankingMedal(index)}</div>
          <h4 style="margin-bottom: 0.25rem;">${u.nome}</h4>
          <p style="color: var(--primary); font-weight: 700; margin-bottom: 0; font-size: 1.1rem;">${u.pontos.toLocaleString('pt-BR')} pts</p>
          <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.25rem;">NÃ­vel ${u.nivel}</p>
        </div>
      `).join("");
    }

    // InicializaÃ§Ã£o
    carregarEstatisticas();
    carregarDestaques();
    carregarRanking();
  </script>
</body>
</html>
